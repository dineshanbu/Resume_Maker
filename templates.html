<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Templates - ResumePro</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./assets/css/style.css">
    <style>
        .category-tabs {
            display: flex;
            gap: 0.625rem;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 2.5rem;
        }
        
        .category-tab {
            padding: 0.625rem 1.5rem;
            border: 2px solid var(--gray-200);
            background: white;
            border-radius: 2rem;
            font-family: 'Rubik', sans-serif;
            font-weight: 500;
            font-size: 0.9rem;
            color: var(--gray-700);
            transition: all var(--transition-base);
            cursor: pointer;
        }
        
        .category-tab:hover {
            border-color: var(--primary-blue);
            color: var(--primary-blue);
            transform: translateY(-2px);
        }
        
        .category-tab.active {
            background: var(--gradient-primary);
            color: white;
            border-color: transparent;
            box-shadow: var(--shadow-sm);
        }
        
        .templates-count {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-left: 0.375rem;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top" data-testid="main-navbar">
        <div class="container">
            <a class="navbar-brand fw-bold" href="index.html" data-testid="navbar-brand">
                <i class="bi bi-file-earmark-text text-primary"></i>
                <span class="text-primary">Resume</span><span class="text-dark">Pro</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-lg-center">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="dashboard.html">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="pricing.html">Pricing</a>
                    </li>
                    <li class="nav-item ms-lg-2">
                        <a class="btn btn-primary" href="resume-builder.html" data-testid="create-resume-btn">
                            <i class="bi bi-plus-circle me-1"></i>Create Resume
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Header Section -->
    <section class="py-4 bg-light" data-testid="header-section">
        <div class="container">
            <div class="text-center">
                <h1 class="display-5 fw-bold mb-2">Professional Resume Templates</h1>
                <p class="lead text-muted mb-0">Choose from <span class="text-primary fw-bold" id="totalCount">12</span> ATS-optimized templates</p>
            </div>
        </div>
    </section>

    <!-- Templates Section -->
    <section class="py-6" data-testid="templates-section">
        <div class="container">
            <!-- Category Tabs -->
            <div class="category-tabs" id="categoryTabs">
                <button class="category-tab active" data-category="all" onclick="filterTemplates('all')" data-testid="filter-all">
                    All Templates<span class="templates-count" id="count-all">12</span>
                </button>
                <button class="category-tab" data-category="basic" onclick="filterTemplates('basic')" data-testid="filter-basic">
                    Basic<span class="templates-count" id="count-basic">3</span>
                </button>
                <button class="category-tab" data-category="modern" onclick="filterTemplates('modern')" data-testid="filter-modern">
                    Modern<span class="templates-count" id="count-modern">5</span>
                </button>
                <button class="category-tab" data-category="premium" onclick="filterTemplates('premium')" data-testid="filter-premium">
                    Premium<span class="templates-count" id="count-premium">3</span>
                </button>
                <button class="category-tab" data-category="ats" onclick="filterTemplates('ats')" data-testid="filter-ats">
                    <i class="bi bi-shield-check me-1"></i>ATS Optimized<span class="templates-count" id="count-ats">10</span>
                </button>
            </div>

            <!-- Templates Grid -->
            <div id="templatesGrid" class="row g-3">
                <!-- Templates will be loaded here -->
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="py-5 bg-light" data-testid="cta-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8 text-center">
                    <h2 class="fw-bold mb-2" style="font-size: 2rem;">Ready to Build Your Resume?</h2>
                    <p class="lead text-muted mb-3">Choose a template and create your professional resume in minutes</p>
                    <a href="resume-builder.html" class="btn btn-primary btn-lg" data-testid="start-building-btn">
                        <i class="bi bi-rocket-takeoff me-2"></i>Start Building Now
                    </a>
                </div>
            </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="./assets/js/auth.js"></script>
    <script>
        const templates = [
            { id: 1, name: 'Professional', category: 'basic', rating: 4.9, reviews: 1243, premium: false, atsOptimized: true, description: 'Clean and modern design', img: '/assets/r2.jpg' },
            { id: 2, name: 'Modern', category: 'modern', rating: 4.7, reviews: 856, premium: true, atsOptimized: true, description: 'Contemporary style', img: '/assets/r1.jpg' },
            { id: 3, name: 'Creative', category: 'modern', rating: 4.8, reviews: 2145, premium: false, atsOptimized: false, description: 'Unique creative layout', img: '/assets/r3.jpg' },
            { id: 4, name: 'Executive', category: 'premium', rating: 5.0, reviews: 643, premium: true, atsOptimized: true, description: 'Premium senior design', img: '/assets/r2.jpg' },
            { id: 5, name: 'Minimal', category: 'basic', rating: 4.6, reviews: 987, premium: false, atsOptimized: true, description: 'Simple minimalist', img: '/assets/r1.jpg' },
            { id: 6, name: 'Tech Pro', category: 'modern', rating: 4.8, reviews: 1534, premium: true, atsOptimized: true, description: 'Ideal for tech pros', img: '/assets/r3.jpg' },
            { id: 7, name: 'Classic', category: 'basic', rating: 4.5, reviews: 734, premium: false, atsOptimized: true, description: 'Traditional format', img: '/assets/r2.jpg' },
            { id: 8, name: 'Bold', category: 'modern', rating: 4.7, reviews: 1098, premium: true, atsOptimized: false, description: 'Strong impression', img: '/assets/r1.jpg' },
            { id: 9, name: 'Elegant', category: 'premium', rating: 4.9, reviews: 876, premium: true, atsOptimized: true, description: 'Sophisticated style', img: '/assets/r3.jpg' },
            { id: 10, name: 'Simple', category: 'basic', rating: 4.4, reviews: 567, premium: false, atsOptimized: true, description: 'Effective design', img: '/assets/r2.jpg' },
            { id: 11, name: 'Corporate', category: 'premium', rating: 4.8, reviews: 945, premium: true, atsOptimized: true, description: 'Corporate style', img: '/assets/r1.jpg' },
            { id: 12, name: 'Contemporary', category: 'modern', rating: 4.6, reviews: 712, premium: false, atsOptimized: true, description: 'Modern approach', img: '/assets/r3.jpg' }
        ];

        let currentCategory = 'all';

        function loadTemplates() {
            const grid = document.getElementById('templatesGrid');
            const filteredTemplates = currentCategory === 'all' 
                ? templates 
                : currentCategory === 'ats'
                    ? templates.filter(t => t.atsOptimized)
                    : templates.filter(t => t.category === currentCategory);

            const badgeTypes = [
                { condition: t => t.atsOptimized && !t.premium, class: 'bg-success-subtle text-success', icon: 'shield-check', text: 'ATS Friendly' },
                { condition: t => t.premium, class: 'bg-primary-subtle text-primary', icon: 'star-fill', text: 'Premium' },
                { condition: t => t.reviews > 1500, class: 'bg-warning-subtle text-warning', icon: 'fire', text: 'Popular' },
                { condition: t => !t.premium && !t.atsOptimized, class: 'bg-secondary-subtle text-secondary', icon: 'check-circle', text: 'Free' }
            ];

            grid.innerHTML = filteredTemplates.map((template) => {
                const badge = badgeTypes.find(b => b.condition(template)) || badgeTypes[badgeTypes.length - 1];
                
                return `
                    <div class="col-lg-3 col-md-4 col-sm-6" data-aos="fade-up">
                        <div class="template-card" data-testid="template-card-${template.id}">
                            <div class="template-preview">
                                <div class="template-header">
                                    <span class="template-badge ${badge.class}">
                                        <i class="bi bi-${badge.icon} me-1"></i>${badge.text}
                                    </span>
                                    <button class="template-action-btn" title="Preview" onclick="previewTemplate('${template.name}')">
                                        <i class="bi bi-eye-fill"></i>
                                    </button>
                                </div>
                                <div class="template-placeholder">
                                    <img src="${template.img}" alt="${template.name} Template">
                                </div>
                            </div>
                            <div class="template-info">
                                <h5 class="mb-2 fw-bold">${template.name}</h5>
                                <p class="text-muted small mb-2">${template.description}</p>
                                <div class="rating mb-2">
                                    ${generateStars(template.rating)}
                                    <small class="text-muted ms-1 fw-semibold">${template.rating}</small>
                                </div>
                                <button class="btn btn-primary btn-sm w-100 mt-auto" onclick="selectTemplate('${template.name}', ${template.premium})">
                                    <i class="bi bi-check-circle me-1"></i>Use Template
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            // Reinitialize AOS for new elements
            if (typeof AOS !== 'undefined') {
                AOS.refresh();
            }
        }

        function generateStars(rating) {
            let stars = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 !== 0;
            
            for (let i = 0; i < fullStars; i++) {
                stars += '<i class="bi bi-star-fill text-warning"></i>';
            }
            if (hasHalfStar) {
                stars += '<i class="bi bi-star-half text-warning"></i>';
            }
            for (let i = Math.ceil(rating); i < 5; i++) {
                stars += '<i class="bi bi-star text-warning"></i>';
            }
            return stars;
        }

        function formatNumber(num) {
            if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'k';
            }
            return num.toString();
        }

        function filterTemplates(category) {
            currentCategory = category;
            
            // Update active tab
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-category="${category}"]`).classList.add('active');
            
            loadTemplates();
        }

        function previewTemplate(templateName) {
            alert(`Preview for ${templateName} template\n\nThis feature will show a full preview of the template.`);
        }

        function selectTemplate(templateName, isPremium) {
            const user = getCurrentUser();
            
            if (isPremium && (!user || user.plan !== 'premium')) {
                if (confirm(`"${templateName}" is a premium template. Would you like to upgrade to Premium?`)) {
                    window.location.href = 'pricing.html';
                }
                return;
            }
            
            if (!user) {
                if (confirm('Please login to use this template. Would you like to login now?')) {
                    window.location.href = 'login.html';
                }
                return;
            }
            
            window.location.href = `resume-builder.html?template=${encodeURIComponent(templateName)}`;
        }

        // Update counts on load
        function updateCounts() {
            document.getElementById('count-all').textContent = templates.length;
            document.getElementById('count-basic').textContent = templates.filter(t => t.category === 'basic').length;
            document.getElementById('count-modern').textContent = templates.filter(t => t.category === 'modern').length;
            document.getElementById('count-premium').textContent = templates.filter(t => t.category === 'premium').length;
            document.getElementById('count-ats').textContent = templates.filter(t => t.atsOptimized).length;
            document.getElementById('totalCount').textContent = templates.length;
        }

        // Load templates on page load
        updateCounts();
        loadTemplates();
    </script>
    
    <!-- AOS Animation -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({
            duration: 500,
            once: true,
            offset: 50
        });
    </script>
</body>
</html>