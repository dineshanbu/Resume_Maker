<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - ResumePro</title>
    
    <!-- BLOCKING ADMIN GUARD - Must be first -->
    <script src="/assets/js/admin-guard.js"></script>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/admin/admin.css">
</head>
<body>
    <!-- Sidebar -->
    <aside class="admin-sidebar" id="adminSidebar" data-testid="admin-sidebar">
        <div class="sidebar-header">
            <div class="logo-section">
                <i class="bi bi-file-earmark-text"></i>
                <h4>Resume<span>Pro</span></h4>
            </div>
            <button class="sidebar-toggle" id="sidebarToggle" data-testid="sidebar-toggle">
                <i class="bi bi-chevron-left"></i>
            </button>
        </div>

        <nav class="sidebar-nav">
            <!-- Admin Dashboard -->
            <div class="nav-section">
                <div class="nav-section-title">ADMIN DASHBOARD</div>
                <a href="#dashboard" class="nav-item active" data-route="dashboard" data-testid="nav-dashboard">
                    <i class="bi bi-speedometer2"></i>
                    <span>Overview & Stats</span>
                </a>
            </div>

            <!-- Template Management -->
            <div class="nav-section">
                <div class="nav-section-title">TEMPLATE MANAGEMENT</div>
                <a href="#templates" class="nav-item" data-route="templates" data-testid="nav-all-templates">
                    <i class="bi bi-file-earmark-text"></i>
                    <span>All Templates</span>
                </a>
                <a href="#create-template" class="nav-item" data-route="create-template" data-testid="nav-create-template">
                    <i class="bi bi-plus-circle"></i>
                    <span>Create New Template</span>
                </a>
                <a href="#categories" class="nav-item" data-route="categories" data-testid="nav-categories">
                    <i class="bi bi-folder"></i>
                    <span>Categories</span>
                </a>
                <a href="#pending-review" class="nav-item" data-route="pending-review" data-testid="nav-pending-review">
                    <i class="bi bi-clock-history"></i>
                    <span>Pending Review</span>
                    <span class="badge-count">5</span>
                </a>
                <a href="#template-analytics" class="nav-item" data-route="template-analytics" data-testid="nav-template-analytics">
                    <i class="bi bi-graph-up"></i>
                    <span>Template Analytics</span>
                </a>
            </div>

            <!-- User Management -->
            <div class="nav-section">
                <div class="nav-section-title">USER MANAGEMENT</div>
                <a href="#users" class="nav-item" data-route="users" data-testid="nav-all-users">
                    <i class="bi bi-people"></i>
                    <span>All Users</span>
                </a>
                <a href="#job-seekers" class="nav-item" data-route="job-seekers" data-testid="nav-job-seekers">
                    <i class="bi bi-person-badge"></i>
                    <span>Job Seekers</span>
                </a>
                <a href="#employers" class="nav-item" data-route="employers" data-testid="nav-employers">
                    <i class="bi bi-building"></i>
                    <span>Employers</span>
                </a>
                <a href="#admins" class="nav-item" data-route="admins" data-testid="nav-admins">
                    <i class="bi bi-shield-check"></i>
                    <span>Admins</span>
                </a>
            </div>

            <!-- Subscription Management -->
            <div class="nav-section">
                <div class="nav-section-title">SUBSCRIPTION MANAGEMENT</div>
                <a href="#subscription-plans" class="nav-item" data-route="subscription-plans" data-testid="nav-subscription-plans">
                    <i class="bi bi-credit-card"></i>
                    <span>Subscription Plans</span>
                </a>
                <a href="#edit-plans" class="nav-item" data-route="edit-plans" data-testid="nav-edit-plans">
                    <i class="bi bi-pencil-square"></i>
                    <span>Edit Plans</span>
                </a>
                <a href="#transactions" class="nav-item" data-route="transactions" data-testid="nav-transactions">
                    <i class="bi bi-receipt"></i>
                    <span>Transactions</span>
                </a>
                <a href="#revenue-analytics" class="nav-item" data-route="revenue-analytics" data-testid="nav-revenue-analytics">
                    <i class="bi bi-currency-dollar"></i>
                    <span>Revenue Analytics</span>
                </a>
            </div>

            <!-- Job Management -->
            <div class="nav-section">
                <div class="nav-section-title">JOB MANAGEMENT</div>
                <a href="#jobs" class="nav-item" data-route="jobs" data-testid="nav-all-jobs">
                    <i class="bi bi-briefcase"></i>
                    <span>All Jobs</span>
                </a>
                <a href="#reported-jobs" class="nav-item" data-route="reported-jobs" data-testid="nav-reported-jobs">
                    <i class="bi bi-flag"></i>
                    <span>Reported Jobs</span>
                    <span class="badge-count">2</span>
                </a>
                <a href="#featured-jobs" class="nav-item" data-route="featured-jobs" data-testid="nav-featured-jobs">
                    <i class="bi bi-star"></i>
                    <span>Featured Jobs</span>
                </a>
                <a href="#job-analytics" class="nav-item" data-route="job-analytics" data-testid="nav-job-analytics">
                    <i class="bi bi-bar-chart"></i>
                    <span>Job Analytics</span>
                </a>
            </div>

            <!-- Content Management -->
            <div class="nav-section">
                <div class="nav-section-title">CONTENT MANAGEMENT</div>
                <a href="#email-templates" class="nav-item" data-route="email-templates" data-testid="nav-email-templates">
                    <i class="bi bi-envelope"></i>
                    <span>Email Templates</span>
                </a>
                <a href="#landing-page" class="nav-item" data-route="landing-page" data-testid="nav-landing-page">
                    <i class="bi bi-house"></i>
                    <span>Landing Page</span>
                </a>
                <a href="#faqs" class="nav-item" data-route="faqs" data-testid="nav-faqs">
                    <i class="bi bi-question-circle"></i>
                    <span>FAQs & Help</span>
                </a>
            </div>

            <!-- Analytics & Reports -->
            <div class="nav-section">
                <div class="nav-section-title">ANALYTICS & REPORTS</div>
                <a href="#user-statistics" class="nav-item" data-route="user-statistics" data-testid="nav-user-statistics">
                    <i class="bi bi-people"></i>
                    <span>User Statistics</span>
                </a>
                <a href="#revenue-reports" class="nav-item" data-route="revenue-reports" data-testid="nav-revenue-reports">
                    <i class="bi bi-cash-stack"></i>
                    <span>Revenue Reports</span>
                </a>
                <a href="#template-usage" class="nav-item" data-route="template-usage" data-testid="nav-template-usage">
                    <i class="bi bi-pie-chart"></i>
                    <span>Template Usage</span>
                </a>
                <a href="#job-statistics" class="nav-item" data-route="job-statistics" data-testid="nav-job-statistics">
                    <i class="bi bi-graph-up-arrow"></i>
                    <span>Job Statistics</span>
                </a>
            </div>

            <!-- Settings -->
            <div class="nav-section">
                <div class="nav-section-title">SETTINGS</div>
                <a href="#system-settings" class="nav-item" data-route="system-settings" data-testid="nav-system-settings">
                    <i class="bi bi-gear"></i>
                    <span>System Settings</span>
                </a>
                <a href="#email-config" class="nav-item" data-route="email-config" data-testid="nav-email-config">
                    <i class="bi bi-envelope-at"></i>
                    <span>Email Configuration</span>
                </a>
                <a href="#payment-gateway" class="nav-item" data-route="payment-gateway" data-testid="nav-payment-gateway">
                    <i class="bi bi-credit-card-2-front"></i>
                    <span>Payment Gateway</span>
                </a>
            </div>
        </nav>
    </aside>

    <!-- Main Content Wrapper -->
    <div class="admin-main-wrapper" id="mainWrapper">
        <!-- Top Navbar -->
        <header class="admin-navbar" data-testid="admin-navbar">
            <div class="navbar-left">
                <button class="mobile-menu-toggle" id="mobileMenuToggle" data-testid="mobile-menu-toggle">
                    <i class="bi bi-list"></i>
                </button>
                <h1 class="page-title" id="pageTitle" data-testid="page-title">Overview & Stats</h1>
            </div>

            <div class="navbar-right">
                <button class="notification-btn" title="Notifications" data-testid="notification-btn">
                    <i class="bi bi-bell"></i>
                    <span class="notification-badge">3</span>
                </button>

                <div class="dropdown">
                    <div class="admin-profile" data-bs-toggle="dropdown" data-testid="admin-profile-dropdown">
                        <div class="admin-avatar" id="adminAvatar">A</div>
                        <div class="admin-info">
                            <h6 id="adminName">Admin User</h6>
                            <p>Administrator</p>
                        </div>
                        <i class="bi bi-chevron-down"></i>
                    </div>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="#profile" data-testid="profile-link"><i class="bi bi-person"></i> Profile</a></li>
                        <li><a class="dropdown-item" href="#settings" data-testid="settings-link"><i class="bi bi-gear"></i> Settings</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#" onclick="handleLogout(event)" data-testid="logout-link"><i class="bi bi-box-arrow-right"></i> Logout</a></li>
                    </ul>
                </div>
            </div>
        </header>

        <!-- Dynamic Content Area -->
        <main class="admin-content" id="adminContent" data-testid="admin-content">
            <!-- Content loaded dynamically -->
        </main>
    </div>

    <!-- Scripts - CRITICAL LOAD ORDER -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- STEP 1: Configuration -->
    <script src="/assets/js/config.js"></script>
    
    <!-- STEP 2: Global Utilities (Alerts) -->
    <script src="/assets/js/alerts.js"></script>
    
    <!-- STEP 3: Authentication Manager -->
    <script src="/assets/js/auth.js"></script>
    
    <!-- STEP 4: API Service (MUST load before controllers) -->
    <script src="/assets/js/api.js"></script>
    
    <!-- STEP 5: Controllers (depend on apiService) -->
    <script src="/admin/controllers/dashboard.controller.js"></script>
    <script src="/admin/controllers/templates.controller.js"></script>
    <script src="/admin/controllers/categories.controller.js"></script>
    
    <!-- STEP 6: Admin Router (initializes everything) -->
    <script src="/admin/admin.js"></script>
</body>
</html>